<!-- pages/order/detail/detail.wxml -->
<view class="container" wx:if="{{!loading}}">
  <!-- 订单状态 -->
  <view class="status-bar" style="background-color: {{statusMap[orderDetail.status].color}}">
    <view class="status-text">{{statusMap[orderDetail.status].text}}</view>
    <view class="order-number">订单号: {{orderDetail.number}}</view>
  </view>
  
  <!-- 桌位信息，仅在有桌位信息时显示 -->
  <view class="section table-info" wx:if="{{orderDetail.tableId}}">
    <view class="section-title">桌位信息</view>
    <view class="table-content">
      <view class="table-name">{{orderDetail.tableName || '桌号:' + orderDetail.tableId}}</view>
      <view class="table-code" wx:if="{{orderDetail.tableCode}}">编码：{{orderDetail.tableCode}}</view>
    </view>
  </view>
  
  <!-- 订单信息 -->
  <view class="section order-info">
    <view class="section-title">订单信息</view>
    <view class="info-item">
      <text class="info-label">下单时间</text>
      <text class="info-value">{{orderDetail.createTime}}</text>
    </view>
    <view class="info-item">
      <text class="info-label">支付方式</text>
      <text class="info-value">{{orderDetail.payMethod === 1 ? '微信支付' : '餐后支付'}}</text>
    </view>
    <view class="info-item" wx:if="{{orderDetail.payStatus === 1}}">
      <text class="info-label">支付时间</text>
      <text class="info-value">{{orderDetail.payTime}}</text>
    </view>
    <view class="info-item" wx:if="{{orderDetail.remark}}">
      <text class="info-label">备注</text>
      <text class="info-value">{{orderDetail.remark}}</text>
    </view>
  </view>
  
  <!-- 订单商品列表 -->
  <view class="section order-dishes">
    <view class="section-title">订单菜品</view>
    <view class="dish-list">
      <view class="dish-item" wx:for="{{orderDetail.orderDetails}}" wx:key="id">
        <image class="dish-image" src="{{item.dishImage || '/images/default_dish.png'}}" mode="aspectFill"></image>
        <view class="dish-info">
          <view class="dish-name">{{item.dishName}}</view>
          <view class="dish-spec" wx:if="{{item.specificationName}}">规格：{{item.specificationName}}</view>
          <view class="dish-bottom">
            <text class="dish-price price">¥{{item.amount / item.number}}</text>
            <text class="dish-count">x{{item.number}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
  
  <!-- 订单金额 -->
  <view class="section amount-info">
    <view class="amount-row">
      <text>总金额</text>
      <text class="price">¥{{orderDetail.amount}}</text>
    </view>
  </view>
  
  <!-- 底部操作区 -->
  <view class="bottom-actions" wx:if="{{orderDetail.status === 1}}">
    <view class="btn cancel" bindtap="cancelOrder">取消订单</view>
    <view class="btn pay" bindtap="payOrder">立即支付</view>
  </view>
</view>

<!-- 加载中 -->
<view class="loading-container" wx:else>
  <view class="loading">
    <image class="loading-icon" src="/images/loading.gif"></image>
    <text>加载中...</text>
  </view>
</view> 